
Installation
============

To setup the tests:

    virtualenv .venv
    . .venv/bin/activate
    pip install nose coverage nosexcover redis eventlet

Then you can repeatedly run:

    nosetests --where=tests --with-xcoverage --cover-erase --cover-package=redismultiwrite

To install the package `redismultiwrite` onto your system:

    sudo python setup.py install

Usage
=====

Create `redis.StrictRedis`[[1]](https://github.com/andymccurdy/redis-py)
objects for the local datacenter redis instance. This object will be the
authoritative connection, and will determine the success or failure of
subsequent functions.

Then create a list of `redis.StrictRedis` objects for each remote datacenter
redis instance. Cross-datacenter commands will also propogate to these
connections before return. Create the `redismultiwrite.RedisMultiWrite` object
using these two pieces of information:

    local = redis.StrictRedis(host='localhost')
    remote = [redis.StrictRedis(host='redis.example.com')]
    conn = redismultiwrite.RedisMultiWrite(local, remote)

The new `RedisMultiWrite` object will functionally mimic a `StrictRedis` object,
routing all standard calls to the local `StrictRedis` object.

The `RedisMultiWrite` object will also have 4 extra methods: `set_everywhere`,
`delete_everywhere`, `expire_everywhere`, and `setex_everywhere`. These methods
correspond to the original, with the added benefit of simultaneously being
performed against all the remote redis connections.

For example, if I called `delete_everywhere`, a `DELETE` command would be sent
to every supplied redis connection and the function call would not return until
all of them have returned success or failure (or thrown an exception). However,
*only* the local redis connection's response will be returned (or thrown) by
`delete_everywhere`. The responses or exceptions generated by remote redis
connections will be discarded.

